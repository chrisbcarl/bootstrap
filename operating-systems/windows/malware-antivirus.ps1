# https://x.com/t3chfalcon/status/2014149985789431949?s=46&t=t9c3IQBqVSTZr1NTjXnIWg

schtasks /query /fo LIST /v > ignoreme/tasks.log

$tasks = (Get-ScheduledTask)
$tasks | ForEach-Object {
    # if (-not $_.Taskname.Trim()) {
    #     $_ | Format-List
    #     $_.Actions | Format-List
    # }
    # TODO: refine this approach a bit...
    $info = (Get-ScheduledTaskInfo -TaskName $_.Taskname -TaskPath $_.TaskPath -ErrorAction SilentlyContinue)
    $actions = $_.Actions

    Write-Host "$($_.Author) - $($_.Description)"
    if ($info) {
        Write-Host "    LastRun - $($info.LastRunTime) | NextRun - $($info.NextRunTime)"
    }
    $actions | ForEach-Object {
        Write-Host "        Exe - '$($_.Execute)'"
    }
}